<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zen Dashboard</title>
    <style>
        /* --- 1. CORE VISUALS --- */
        :root {
            --bg-color: #050505;
            --glass: rgba(15, 15, 15, 0.6);
            --glass-border: rgba(255, 255, 255, 0.08);
            --accent: #00f3ff;
            --danger: #ff0055;
        }

        body {
            margin: 0;
            background-color: var(--bg-color);
            background-image: radial-gradient(circle at 50% 50%, #111 0%, #000 100%);
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            font-family: 'Segoe UI', Roboto, sans-serif;
            color: #fff;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Scanline Overlay - Made subtler */
        body::before {
            content: '';
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.05) 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 0;
        }

        /* --- 2. HEADER & CLOCK --- */
        #header {
            margin-top: 5vh;
            margin-bottom: 2vh;
            text-align: center;
            z-index: 10;
        }
        #clock {
            font-size: 6rem;
            font-weight: 200;
            letter-spacing: 4px;
            color: rgba(255,255,255,0.9);
            text-shadow: 0 0 40px rgba(0, 243, 255, 0.15);
            font-variant-numeric: tabular-nums;
            transition: all 1s ease;
        }
        #date {
            font-size: 0.9rem;
            letter-spacing: 6px;
            text-transform: uppercase;
            color: rgba(255,255,255,0.4);
            margin-top: -10px;
        }

        /* --- 3. SCROLLABLE INFINITE CONTAINER --- */
        #viewport {
            width: 90vw;
            max-width: 1300px;
            flex-grow: 1;
            margin-bottom: 100px; 
            overflow-y: auto;
            overflow-x: hidden;
            padding: 40px 20px; /* More padding for float movement */
            z-index: 10;
            scrollbar-width: thin;
            scrollbar-color: var(--glass-border) transparent;
        }
        
        #viewport::-webkit-scrollbar { width: 6px; }
        #viewport::-webkit-scrollbar-track { background: transparent; }
        #viewport::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }

        #bubble-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 45px; /* More space for breathing room */
            padding-bottom: 50px;
        }

        /* --- 4. BUBBLE ITEM --- */
        .bubble-wrapper {
            position: relative;
            width: 70px;
            height: 70px;
            display: flex;
            justify-content: center;
            align-items: center;
            /* No transition on wrapper to allow independent animation */
        }

        /* EDIT MODE: Gentle Shake (Re-enabled but very subtle) */
        .edit-mode .bubble-wrapper {
            animation: none; /* Disable native float */
            cursor: grab;
        }
        .edit-mode .bubble {
            animation: shake 3s ease-in-out infinite !important;
            border-color: var(--accent);
            box-shadow: 0 0 15px var(--accent);
        }
        .edit-mode .bubble-wrapper:active { cursor: grabbing; }

        @keyframes shake {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(1deg); }
            75% { transform: rotate(-1deg); }
            100% { transform: rotate(0deg); }
        }

        /* --- LIQUID MORPH ANIMATIONS --- */
        @keyframes liquidMorph {
            0% { border-radius: 50%; }
            33% { border-radius: 55% 45% 50% 50% / 50% 55% 45% 50%; }
            66% { border-radius: 45% 55% 45% 55% / 55% 45% 50% 50%; }
            100% { border-radius: 50%; }
        }
        @keyframes gentleFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes steadyGlow {
            0%, 100% { box-shadow: 0 5px 15px rgba(0,0,0,0.5), 0 0 10px rgba(0, 243, 255, 0.05); }
            50% { box-shadow: 0 5px 15px rgba(0,0,0,0.5), 0 0 20px rgba(0, 243, 255, 0.15); }
        }

        /* BUBBLE STYLE: Liquid & Calm */
        .bubble {
            width: 55px;
            height: 55px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            
            /* Combine animations: Float + Morph + Glow */
            /* Durations will be randomized in JS for organic feel */
            animation: 
                gentleFloat 6s ease-in-out infinite,
                liquidMorph 8s ease-in-out infinite,
                steadyGlow 5s ease-in-out infinite;

            transition: background 0.5s ease, border-color 0.5s ease, transform 0.5s ease;
        }

        .bubble:hover {
            /* Pauses float on hover so you can click easily */
            animation-play-state: paused;
            transform: scale(1.1) translateY(-5px); /* Gentle lift */
            border-color: rgba(255,255,255,0.5);
            background: rgba(40,40,40,0.6);
            box-shadow: 0 15px 40px rgba(0,0,0,0.5), 0 0 40px rgba(0, 243, 255, 0.2);
            z-index: 10;
        }

        .bubble-icon {
            width: 26px;
            height: 26px;
            object-fit: contain;
            pointer-events: none;
            image-rendering: -webkit-optimize-contrast;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.4));
            transition: transform 0.5s ease;
        }
        
        .bubble:hover .bubble-icon {
            transform: scale(1.1);
        }

        .bubble-name {
            position: absolute;
            bottom: -30px;
            font-size: 10px;
            color: rgba(255,255,255,0.8);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            pointer-events: none;
            background: rgba(0,0,0,0.8);
            padding: 4px 8px;
            border-radius: 6px;
            opacity: 0;
            transition: opacity 0.4s ease, transform 0.4s ease;
            white-space: nowrap;
            transform: translateY(-5px);
        }
        .bubble:hover .bubble-name { 
            opacity: 1; 
            transform: translateY(0);
        }

        .bubble-initial {
            font-size: 24px;
            font-weight: 700;
            color: #fff;
            display: none;
        }

        /* --- 5. UI CONTROLS --- */
        .toolbar {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            gap: 15px;
            z-index: 100;
        }

        /* FAB STYLE - Steady & Deep */
        .fab {
            width: 50px; height: 50px;
            border-radius: 50%;
            background: rgba(20, 20, 20, 0.6);
            border: 1px solid rgba(255,255,255,0.1);
            color: rgba(255, 255, 255, 0.7);
            display: flex; justify-content: center; align-items: center;
            font-size: 22px; cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
        
        .fab:hover { 
            background: rgba(30, 30, 30, 0.9);
            border-color: var(--accent);
            color: var(--accent);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 243, 255, 0.2);
        }
        
        .fab.active { 
            background: var(--accent); 
            color: #000; 
            box-shadow: 0 0 30px var(--accent);
            transform: scale(1.1);
        }

        /* --- 6. MODALS --- */
        .modal-overlay {
            display: none;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 200;
            justify-content: center; align-items: center;
            backdrop-filter: blur(10px);
            transition: opacity 0.3s;
        }
        .modal-card {
            background: #090909;
            border: 1px solid #333;
            padding: 30px;
            border-radius: 20px;
            width: 320px;
            box-shadow: 0 0 80px rgba(0,0,0,0.8);
            text-align: center;
            border-top: 1px solid #444;
        }
        h2 { margin-top: 0; font-weight: 300; letter-spacing: 2px; font-size: 18px; color: #ccc;}
        input[type="text"] {
            width: 100%; padding: 12px; margin-bottom: 15px;
            background: #111; border: 1px solid #333; color: #fff;
            border-radius: 8px; outline: none; box-sizing: border-box;
            transition: border-color 0.3s;
        }
        input:focus { border-color: var(--accent); }
        
        .btn {
            width: 100%; padding: 12px;
            background: #fff; color: #000;
            border: none; border-radius: 8px;
            font-weight: 700; cursor: pointer; margin-top: 5px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(255,255,255,0.2); }
        .btn-secondary { background: #222; color: #aaa; margin-top: 10px; }
        .btn-secondary:hover { color: #fff; background: #333; }
        
        .backup-row { display: flex; gap: 10px; margin-top: 20px; }
        .btn-backup { flex: 1; font-size: 11px; padding: 10px; background: #1a1a1a; border: 1px solid #333; color: #888; border-radius: 6px; cursor: pointer; transition: 0.3s; }
        .btn-backup:hover { border-color: #666; color: #fff; background: #222; }
        
        .file-upload-btn {
            display: block;
            border: 1px dashed #444;
            padding: 15px;
            margin-bottom: 15px;
            color: #666;
            font-size: 12px;
            cursor: pointer;
            border-radius: 8px;
            transition: 0.3s;
        }
        .file-upload-btn:hover { border-color: var(--accent); color: var(--accent); background: rgba(0, 243, 255, 0.05); }

    </style>
</head>
<body>

    <div id="header">
        <div id="clock">00:00</div>
        <div id="date">SYSTEM READY</div>
    </div>

    <!-- Scrollable Viewport -->
    <div id="viewport">
        <div id="bubble-grid"></div>
    </div>

    <!-- Toolbar -->
    <div class="toolbar">
        <div class="fab" id="edit-btn" onclick="toggleEditMode()" title="Toggle Edit/Drag Mode">âœŽ</div>
        <div class="fab" onclick="openModal('add-modal')">+</div>
        <div class="fab" onclick="openModal('settings-modal')">âš™</div>
    </div>

    <!-- ADD MODAL -->
    <div id="add-modal" class="modal-overlay">
        <div class="modal-card">
            <h2>NEW LINK</h2>
            <input type="text" id="inp-name" placeholder="Name (e.g. Work)">
            <input type="text" id="inp-url" placeholder="URL (e.g. notion.so)">
            <button class="btn" onclick="addItem()">Add to Grid</button>
            <button class="btn btn-secondary" onclick="closeModals()">Cancel</button>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="settings-modal" class="modal-overlay">
        <div class="modal-card">
            <h2>SETTINGS</h2>
            
            <label class="file-upload-btn">
                ðŸ“‚ Upload Local Wallpaper
                <input type="file" accept="image/*" style="display:none" onchange="handleFileSelect(this)">
            </label>

            <input type="text" id="inp-bg-url" placeholder="Or Paste Wallpaper URL" onchange="handleUrlBg(this.value)">
            
            <div style="margin: 20px 0; border-top: 1px solid #222;"></div>
            <p style="font-size: 10px; color: #555; margin-bottom: 10px; letter-spacing: 1px;">DATA VAULT</p>
            
            <div class="backup-row">
                <button class="btn-backup" onclick="exportData()">â¬‡ BACKUP</button>
                <button class="btn-backup" onclick="document.getElementById('file-input').click()">â¬† RESTORE</button>
            </div>
            <input type="file" id="file-input" style="display:none" onchange="importData(this)">

            <button class="btn btn-secondary" style="margin-top: 20px;" onclick="closeModals()">Done</button>
            <p style="font-size: 10px; color: #333; margin-top: 15px; cursor: pointer;" onclick="resetAll()">Factory Reset</p>
        </div>
    </div>

<script>
    // --- STATE ---
    const defaults = [
        { id: 1, name: "Google", url: "https://google.com" },
        { id: 2, name: "YouTube", url: "https://youtube.com" },
        { id: 3, name: "ChatGPT", url: "https://chat.openai.com" },
        { id: 4, name: "GitHub", url: "https://github.com" },
    ];

    let items = [];
    let isEditMode = false;
    let dragSrcEl = null;

    // --- INIT ---
    function init() {
        updateClock();
        setInterval(updateClock, 1000);

        const stored = localStorage.getItem('zen_items');
        items = stored ? JSON.parse(stored) : defaults;

        const bg = localStorage.getItem('zen_bg');
        if(bg) document.body.style.backgroundImage = `url('${bg}')`;

        render();
    }

    // --- RENDER ---
    function render() {
        const grid = document.getElementById('bubble-grid');
        grid.innerHTML = '';

        items.forEach((item, index) => {
            let domain = "google.com";
            try {
                let tempUrl = item.url.startsWith('http') ? item.url : 'https://' + item.url;
                domain = new URL(tempUrl).hostname;
            } catch(e) {}

            const iconUrl = `https://www.google.com/s2/favicons?domain=${domain}&sz=256`;
            const initial = item.name.charAt(0).toUpperCase();

            // Wrapper
            const wrapper = document.createElement('div');
            wrapper.className = 'bubble-wrapper';
            wrapper.dataset.index = index;
            wrapper.draggable = isEditMode; 
            
            // Events
            wrapper.addEventListener('dragstart', handleDragStart);
            wrapper.addEventListener('dragover', handleDragOver);
            wrapper.addEventListener('drop', handleDrop);
            wrapper.addEventListener('dragend', handleDragEnd);

            // Inner Bubble
            const el = document.createElement('div');
            el.className = 'bubble';
            
            // RANDOMIZE ANIMATIONS
            // This prevents them from moving in sync (the "busy" look)
            // Float: 6s to 10s
            // Morph: 7s to 12s
            const floatDur = 6 + Math.random() * 4;
            const morphDur = 7 + Math.random() * 5;
            const glowDur = 4 + Math.random() * 4;
            const delay = Math.random() * -10; // Negative delay starts animation mid-way

            el.style.animationDuration = `${floatDur}s, ${morphDur}s, ${glowDur}s`;
            el.style.animationDelay = `${delay}s, ${delay}s, ${delay}s`;

            el.innerHTML = `
                <img src="${iconUrl}" class="bubble-icon" alt="" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'">
                <span class="bubble-initial">${initial}</span>
                <span class="bubble-name">${item.name}</span>
            `;

            el.onclick = (e) => {
                if(isEditMode) return;
                let url = item.url;
                if(!url.startsWith('http')) url = 'https://' + url;
                window.location.href = url;
            };

            el.oncontextmenu = (e) => {
                e.preventDefault();
                if(confirm(`Delete ${item.name}?`)) deleteItem(item.id);
            };

            wrapper.appendChild(el);
            grid.appendChild(wrapper);
        });
    }

    // --- EDIT MODE & DRAG LOGIC ---
    function toggleEditMode() {
        isEditMode = !isEditMode;
        document.getElementById('edit-btn').classList.toggle('active');
        document.getElementById('bubble-grid').classList.toggle('edit-mode');
        render(); 
    }

    function handleDragStart(e) {
        if(!isEditMode) { e.preventDefault(); return; }
        this.style.opacity = '0.4';
        dragSrcEl = this;
        e.dataTransfer.effectAllowed = 'move';
    }

    function handleDragOver(e) {
        if (e.preventDefault) e.preventDefault();
        e.dataTransfer.dropEffect = 'move';
        return false;
    }

    function handleDrop(e) {
        if (e.stopPropagation) e.stopPropagation();
        if (dragSrcEl !== this) {
            const srcIdx = parseInt(dragSrcEl.dataset.index);
            const targetIdx = parseInt(this.dataset.index);
            const movedItem = items.splice(srcIdx, 1)[0];
            items.splice(targetIdx, 0, movedItem);
            save();
            render();
        }
        return false;
    }

    function handleDragEnd() {
        this.style.opacity = '1';
    }

    // --- CORE FUNCTIONS ---
    function exportData() {
        const dataStr = JSON.stringify(items);
        const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', 'zen_backup.json');
        linkElement.click();
    }

    function importData(input) {
        const file = input.files[0];
        if(!file) return;
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const json = JSON.parse(e.target.result);
                if(Array.isArray(json)) {
                    items = json; save(); render(); alert("Restored."); closeModals();
                } else alert("Invalid file");
            } catch(err) { alert("Error"); }
        };
        reader.readAsText(file);
    }

    function addItem() {
        const name = document.getElementById('inp-name').value;
        const url = document.getElementById('inp-url').value;
        if(!name || !url) return;
        items.push({ id: Date.now(), name, url });
        save(); render(); closeModals();
        document.getElementById('inp-name').value = "";
        document.getElementById('inp-url').value = "";
    }

    function deleteItem(id) {
        items = items.filter(i => i.id !== id);
        save(); render();
    }

    function save() {
        localStorage.setItem('zen_items', JSON.stringify(items));
    }

    function handleFileSelect(input) {
        if (input.files && input.files[0]) {
            const file = input.files[0];
            if(file.size > 4 * 1024 * 1024) return alert("Image too large (Max 4MB)");
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const result = e.target.result;
                    localStorage.setItem('zen_bg', result);
                    document.body.style.backgroundImage = `url('${result}')`;
                    closeModals();
                } catch(err) { alert("Storage full! Use URL option."); }
            };
            reader.readAsDataURL(file);
        }
    }

    function handleUrlBg(url) {
        if(url) {
            localStorage.setItem('zen_bg', url);
            document.body.style.backgroundImage = `url('${url}')`;
        }
    }

    function resetAll() {
        if(confirm("Factory Reset?")) { localStorage.clear(); location.reload(); }
    }

    function updateClock() {
        const now = new Date();
        let h = now.getHours();
        const m = String(now.getMinutes()).padStart(2, '0');
        h = h % 12; h = h ? h : 12; 
        document.getElementById('clock').innerText = `${h}:${m}`;
        document.getElementById('date').innerText = now.toLocaleDateString([], {weekday: 'long', month: 'long', day: 'numeric'});
    }

    function openModal(id) { document.getElementById(id).style.display = 'flex'; }
    function closeModals() { document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none'); }

    init();

</script>
</body>
</html>